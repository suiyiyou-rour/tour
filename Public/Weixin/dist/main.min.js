/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(1);
var Alert = __webpack_require__(2);
var toast = __webpack_require__(3);

//读URL参数
function urlKey(name) {
    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
    var r = window.location.search.substr(1).match(reg);
    if (r != null) return encodeURI(r[2]); return null;
}
//设置cookie
function setCookie(name, value, time) {
    var oDate = new Date();
    oDate.setTime(oDate.getTime() + time);
    document.cookie = name + '=' + encodeURIComponent(value) + ';expires=' + oDate.toUTCString();
}
//获取cookie
function getCookie(name) {
    var arr = document.cookie.split('; ');
    var i = 0;
    for (i = 0; i < arr.length; i++) {
        var arr2 = arr[i].split('=');

        if (arr2[0] == name) {
            var getC = decodeURIComponent(arr2[1]);
            return getC;
        }
    }
    return '';
}
//日期计算星期
function getDateWeek(year, month, day) {
    var tmpdate = new Date(year, month - 1, day);
    var json = {
        0: '周日',
        1: '周一',
        2: '周二',
        3: '周三',
        4: '周四',
        5: '周五',
        6: '周六'
    }
    return json[tmpdate.getDay()];
}
//验证身份证
function checkIdentity(identity) {
    var reg = /^[1-9]{1}[0-9]{14}$|^[1-9]{1}[0-9]{16}([0-9]|[xX])$/;
    if (reg.test(identity)) {
        return true;
    } else {
        return false;
    }
}

var bottomTotalPri = $('#bottomTotalPri'),
    KC = +getCookie('kc'),
    nowTotal = 1;       //成人，儿童已选票数的总数量

//从url取数据
var onePrice = getCookie('price'),   //成人价格
    code = urlKey('shopCode'),           //商品id
    type = urlKey('shopType'),           //商品类型
    name = getCookie('name'),        //商品名
    zfInfo = getCookie('zfInfo'),    //自费项目
    date = getCookie('date'),        //出游日期
    dateArr = date.split('-'),
    childPrice = getCookie('childPrice'),   //儿童价格
    dfc = getCookie('dfc'),
    zc = getCookie('zc');

$('#ticketTime').text(date + '(' + getDateWeek(dateArr[0], dateArr[1], dateArr[2]) + ')');
$('#totalPri').text(onePrice);
$('#bottomTotalPri').text(onePrice);

//商品名存半小时cookie，判断是否有商品名
if (name) {
    $('#ticketName').text(name);
} else {
    //没有的话跳转商品详情页面
    location.href = controller + '/p_route?shopCode=' + code + '&shopType=' + type;
}

//自费项目信息
zfInfo = JSON.parse(zfInfo);
if (typeof zfInfo == 'string') { 
    $('#zfTitle').hide();
} else {
    $('#zfNum').html(itemNum(zfInfo));
}

//是否存在儿童价信息
if (childPrice) {
    $('#peopleNum').append(peopleNum(onePrice, '成人', 1), peopleNum(childPrice, '儿童', 0));
} else {
    $('#peopleNum').append(peopleNum(onePrice, '人', 1));
}

if (dfc) {
    
    $('#dfcBox').append('<p class="subtitle">单房数量</p><div class="num-box">' +
        '<p class="one-price">￥<span class="js_pri">' + dfc + '</span>/单房差</p>' +
        '<div class="select-num">' +
        '<p class="js_red"><i class="iconfont icon-jianshao"></i></p>' +
        '<span id="dfcNum" class="choose-num">0</span>' +
        '<p class="js_add"><i class="iconfont icon-zengjia"></i></p>' +
        '</div></div>');

    //单房差增加/减少
    $('#dfcBox').on('click', '.js_red', function () {

        var parent = $(this).parents('.num-box'),
            pri = +parent.find('.js_pri').text() * 100,
            tNum = parent.find('.choose-num'),
            numVal = +tNum.text();

        if (numVal == 0) {
            return false;
        }

        var totalPrice = +bottomTotalPri.text() * 100;
        tNum.text(numVal -= 1);
        totalPrice = ((totalPrice - pri) / 100).toFixed(2);
        Number(totalPrice) == totalPrice ? bottomTotalPri.text(Number(totalPrice)) : totalPrice;

    })

    $('#dfcBox').on('click', '.js_add', function () {

        var parent = $(this).parents('.num-box'),
            pri = +parent.find('.js_pri').text() * 100,
            tNum = parent.find('.choose-num'),
            numVal = +tNum.text();

        if (zc) {
            if (nowTotal == numVal) {
                Alert('单房差已与人数数量一致');
                return false;
            }
        } else {
            if (nowTotal - (+$('.choose-num.man').eq(1).text()) == numVal) {
                Alert('单房差已与成人数量一致');
                return false;
            }
        }

        var totalPrice = +bottomTotalPri.text() * 100;
        tNum.text(numVal += 1);
        totalPrice = ((totalPrice + pri) / 100).toFixed(2);
        Number(totalPrice) == totalPrice ? bottomTotalPri.text(Number(totalPrice)) : totalPrice;

    })
}

//成人儿童不同票价
function peopleNum(price, mantype, num) {
    var html = '<div class="num-box">' +
        '<p class="one-price">￥<span class="js_pri">' + price + '</span>/' + mantype + '</p>' +
        '<div class="select-num">' +
        '<p class="js_red"><i class="iconfont icon-jianshao"></i></p>' +
        '<span data-type=' + num + ' class="choose-num man">' + num + '</span>' +
        '<p class="js_add"><i class="iconfont icon-zengjia"></i></p>' +
        '</div></div>';

    return html;
}

//自费项目
function itemNum(data) {

    var html = '',
        len = data.length;

    for (var i = 0; i < len; i++) {
        html += '<div class="num-box">' +
            '<p class="one-price">￥<span class="js_pri">' + data[i].price + '</span>/人</p>' +
            '<p class="item-name">' + data[i].name + '</p>' +
            '<div class="select-num">' +
            '<p class="js_red"><i class="iconfont icon-jianshao"></i></p>' +
            '<span class="choose-num zf">0</span>' +
            '<p class="js_add"><i class="iconfont icon-zengjia"></i></p>' +
            '</div></div>';
    }

    return html;
}

//减少
$('#ticketNumBox').on('click', '.js_red', function () {

    var parent = $(this).parents('.num-box');
    var pri = +parent.find('.js_pri').text() * 100;
    var tNum = parent.find('.choose-num');
    var numVal = +tNum.text();

    //数量选择
    if (tNum.hasClass('man')) {
    
        if (tNum.attr('data-type') == '1' && numVal == 1) {
            Alert('成人最少购买数量1');
            return false;
        } else if (tNum.attr('data-type') == '0' && numVal == 0) {
            return false;
        }

        nowTotal -= 1;

        var zfItem = $('.choose-num.zf'),
            price = zfItem.parents('.num-box').find('.js_pri');

        for (var i = 0; i < zfItem.length; i++) {
            if (+zfItem.eq(i).text() > nowTotal) {
                zfItem.eq(i).text(nowTotal);
                bottomTotalPri.text((+bottomTotalPri.text() * 100 - +price.eq(i).text() * 100) / 100);
            }
        }

        var dfcDom = $('#dfcNum');
        dfcNum = +dfcDom.text();

        if (dfc && tNum.attr('data-type') == '1') {
            if (zc) {
                if (nowTotal < dfcNum) {
                    dfcDom.text(dfcNum -= 1);
                    bottomTotalPri.text((+bottomTotalPri.text() * 100 - +dfc * 100) / 100);
                }
            } else {
                if (nowTotal - (+$('.choose-num.man').eq(1).text()) < dfcNum) {
                    dfcDom.text(dfcNum -= 1);
                    bottomTotalPri.text((+bottomTotalPri.text() * 100 - +dfc * 100) / 100);
                }
            }
        }
    }



    //自费项目选择
    if (tNum.hasClass('zf')) {
        if (numVal == 0) {
            return false;
        }
    }
    var totalPrice = +bottomTotalPri.text() * 100;
    tNum.text(numVal -= 1);
    totalPrice = ((totalPrice - pri) / 100).toFixed(2);
    Number(totalPrice) == totalPrice ? bottomTotalPri.text(Number(totalPrice)) : totalPrice;
})

//增加
$('#ticketNumBox').on('click', '.js_add', function () {

    var parent = $(this).parents('.num-box'),
        pri = +parent.find('.js_pri').text() * 100,
        tNum = parent.find('.choose-num'),
        numVal = +tNum.text();

    if (tNum.hasClass('man')) {

        if (nowTotal < KC) {
            nowTotal += 1;
        } else {
            Alert('已达到库存上限');
            return false;
        }
    }

    //自费项目选择
    if (tNum.hasClass('zf')) {
        if (numVal == nowTotal) {
            Alert('数量已与人数一致');
            return false;
        }
    }

    var totalPrice = +bottomTotalPri.text() * 100;
    tNum.text(numVal += 1);
    totalPrice = ((totalPrice + pri) / 100).toFixed(2);
    Number(totalPrice) == totalPrice ? bottomTotalPri.text(Number(totalPrice)) : totalPrice;

})



//去填写游客信息
$('#goTourBtn').click(function () {

    if ($('#reserveCheck').prop('checked')) {

        if (confirm('是否确认' + $('#ticketTime').text() + '出行?')) {
            $('#reserveMess').fadeOut(200, function () {
                $('#tourristMess').fadeIn(200);
            });

            var resPrice = bottomTotalPri.text();
            $('#orderTotalPri').text(resPrice);

            var manNum = $('.choose-num.man');
            if (manNum.length == 1) {
                var itemNum = +manNum.text() - 1;
            } else {
                var itemNum = +manNum.eq(0).text() + +manNum.eq(1).text() - 1;
            }
            var html = '';

            for (var i = 0; i < itemNum; i++) {
                html += '<div class="item-container"><div class="item-box"><p class="item-p"><span class="red">' + (i + 2) + '.</span>游客姓名 : </p><input class="item-inp name" placeholder="姓名" type="text"></div>' +
                    '<div class="item-box"><p class="item-p">身份证号 : </p><input class="item-inp identify" type="text" placeholder="若是儿童输入出生日期"></div></div>';
            }

            $('#secItem').html(html);
        }

    } else {
        Alert('请先确认预定须知!!!');
    }
})

//返回
$('.iconfont.icon-zuojiantou').click(function () {
    $('#tourristMess').fadeOut(200, function () {
        $('#reserveMess').fadeIn(200);
    });
})

//确认下单
$('#takeOrderBtn').click(function () {

    var tourName = $('#tourName').val();
    if (!tourName) {
        Alert('请填写第1位游客的真实姓名!');
        return false;
    }

    var tourMobile = $('#tourMobile').val();
    if (tourMobile) {
        if (!(/^1\d{10}$/.test(tourMobile))) {
            Alert("第1位游客手机号码有误，请重填");
            return false;
        }
    } else {
        Alert('请填写第1位游客的手机号码!');
        return false;
    }

    var tourIdentify = $('#tourIdentify').val();
    if (tourIdentify) {
        if (!checkIdentity(tourIdentify)) {
            Alert('第1位游客身份证号码错误!');
            return false;
        }
    } else {
        Alert('请输入第1位游客的身份证号码!');
        return false;
    }

    var remarks = $('#remarks').val();

    var data = {};
    data.info = [];

    var len = $('.item-container').length;

    for (var i = 0; i < len; i++) {
        var itemContainer = $('.item-container').eq(i);
        var nameVal = itemContainer.find('.name').val();
        var idetVal = itemContainer.find('.identify').val();

        if (!nameVal) {
            Alert('请输入第' + (i + 2) + '位游客的姓名!');
            return false;
        }

        if (!idetVal) {
            Alert('请输入第' + (i + 2) + '位游客的身份证或出生日期!');
            return false;
        }

        var json = {
            name: nameVal,
            identify: idetVal
        }

        data.info.push(json);  //身份数组
    }

    data.g_code = urlKey('shopCode');
    data.g_user_id = getCookie('user');
    data.identification = tourIdentify;

    data.mobile = tourMobile; //游客手机
    data.name = tourName;     //第一位游客姓名
    data.jxscode = '';        //以后的分销商pid
    data.remarks = remarks;   //备注
    data.g_on_time = date;    //出行时间
    data.dfcNum = +$('#dfcNum').text();

    if (zfInfo) {
        var zfNum = $('.choose-num.zf');
        for (var i = 0; i < zfInfo.length; i++) {
            zfInfo[i].num = zfNum.eq(i).text();
        }
    }
    //自费项目信息
    data.zfInfo = zfInfo;

    var manNum = $('.choose-num.man');
    //成人 儿童数量
    if (manNum.lenght == 1) {
        data.menNum = manNum.text();
        data.childNum = 0;
    } else {
        data.menNum = manNum.eq(0).text();
        data.childNum = manNum.eq(1).text();
    }

    data.totalPrice = $('#orderTotalPri').text();  //总价

    var _this = $(this);

    _this.prop('disabled', true);
    _this.css('backgroundColor', '#ffa69c');

    toast.show();

    $.ajax({
        url: 'http://www.suiyiyou.net/index.php/weixin/Order/addGroupOrder',
        data: data,
        type: 'POST',
        success: function (res) {
            toast.hide();
            var code = res.code,
                data = res.data;
            if (code == 200) {
                location.href = 'http://www.suiyiyou.net/index.php/Weixin/Jsapi/index?&orderSn=' + data.orderSn + '&shopType=' + type + '&';
            } else {
                Alert(res.msg);
                _this.prop('disabled', false);
                _this.css('backgroundColor', '#ff1900');
            }
        }
    })
})

CONFIG.jsApiList = [    //需要调用的接口
    'onMenuShareTimeline',
    'onMenuShareAppMessage'
]
wx.config(CONFIG);
var link;
if(urlKey('pid')){
    link = location.href;
}else{
    link = location.href + '&pid=' + getCookie('pid');
}
wx.ready(function () {
    //分享朋友圈
    wx.onMenuShareTimeline({
        title: document.title,
        link: link,
        imgUrl: public + '/Weixin/image/wxbg.png'
    });
    //分享朋友
    wx.onMenuShareAppMessage({
        title: document.title,
        desc: '我的旅游小店，随我心，游天下',
        link: link,
        imgUrl: public + '/Weixin/image/wxbg.png',
    });
})

/***/ }),
/* 1 */
/***/ (function(module, exports) {

// removed by extract-text-webpack-plugin

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

var Alert = function(content) {
    var $box = $('<div></div>'),
        $i = $('<i class="iconfont icon-jinggao"></i>'),
        $span = $('<span></span>');

    $box.css({
        position: 'fixed',
        textAlign: 'center',
        width: '180px',
        bottom: '30px',
        left: 'calc(50% - 90px)',
        fontSize: '12px',
        borderRadius: '3px',
        color: '#fff',
        opacity: '0.1',
        background: 'rgba(0,0,0,0.7)'
    });

    $span.css({
        lineHeight: '25px',
    })

    $span.append(content);
    $box.append($span);
    $('body').append($box);
    $box.animate({
        opacity: '1',
        bottom: '50px'
    }, 200, function () {
        setTimeout(function () {
            $box.animate({
                opacity: '0.1',
                bottom: '30px'
            }, function () {
                $box.remove();
            })
        }, 1500)
    })
}

if (true) {
    module.exports = Alert;
} else {
    window.datePrice = Alert;
}



/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

function toast() {

    this.container = $('<div></div>');

    this.container.prop('id', 'loadingPc');

    var loading = $('<div></div>');
    this.container.prop('class', 'loading-box');

    var p = $('<p>请稍后</p>');

    var svg = $('<img src="http://www.suiyiyou.net/Public/common/loading.svg">');

    this.container.css({
        position: 'fixed',
        left: 0,
        top: 0,
        width: '100%',
        height: '100%',
        zIndex: 99,
        display: 'none'
    });

    loading.css({
        width: '100px',
        height: '100px',
        background: 'rgba(0, 0, 0, 0.5)',
        borderRadius: '10px',
        margin: '70% auto 0'
    });

    svg.css({
        margin: '0 auto',
        paddingTop: '10px',
        display: 'block'
    })

    p.css({
        textAlign: 'center',
        color: '#fff',
        fontSize: '14px',
        marginTop: '5px'
    })

    loading.append(svg, p);
    this.container.append(loading);
    $('body').append(this.container);

    this.show = function () {
        this.container.show();
    };

    this.hide = function () {
        this.container.hide();
    }
}

if (true) {
    module.exports = new toast();
} else {
    window.toast = new toast();
}

/***/ })
/******/ ]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgNWVkZjgzNTdhYzkxYmZhODY2NjgiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Rfcm91dGUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Rfcm91dGUvaW5kZXguc2NzcyIsIndlYnBhY2s6Ly8vLi4vY29tbW9uL0FsZXJ0LW1iLmpzIiwid2VicGFjazovLy8uLi9jb21tb24vdG9hc3QuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBMkIsMEJBQTBCLEVBQUU7QUFDdkQseUNBQWlDLGVBQWU7QUFDaEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0EsOERBQXNELCtEQUErRDs7QUFFckg7QUFDQTs7QUFFQTtBQUNBOzs7Ozs7O0FDN0RBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQztBQUN0QztBQUNBLGVBQWUsZ0JBQWdCO0FBQy9COztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsRUFBRSxNQUFNLEdBQUcsU0FBUyxFQUFFLE1BQU0sR0FBRztBQUNyRDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsaUJBQWlCOztBQUVqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxnQztBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsS0FBSzs7QUFFTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxtQkFBbUIsU0FBUztBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQSx1QkFBdUIsbUJBQW1CO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLENBQUM7Ozs7QUFJRDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBLDJCQUEyQixhQUFhO0FBQ3hDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDOztBQUVEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esb0JBQW9CLEdBQUc7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUEsbUJBQW1CLFNBQVM7QUFDNUI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDZCQUE2QjtBQUM3Qjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsNkJBQTZCO0FBQzdCLHlCQUF5QjtBQUN6QixzQkFBc0I7QUFDdEIsMkJBQTJCO0FBQzNCLDBCQUEwQjtBQUMxQjs7QUFFQTtBQUNBO0FBQ0EsdUJBQXVCLG1CQUFtQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBLGlEQUFpRDs7QUFFakQ7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDLEM7Ozs7OztBQ3BkRCx5Qzs7Ozs7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVCxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBOzs7Ozs7OztBQzVDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLEMiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCA1ZWRmODM1N2FjOTFiZmE4NjY2OCIsInJlcXVpcmUoJy4vaW5kZXguc2NzcycpO1xyXG52YXIgQWxlcnQgPSByZXF1aXJlKCdDT01NT04vQWxlcnQtbWIuanMnKTtcclxudmFyIHRvYXN0ID0gcmVxdWlyZSgnQ09NTU9OL3RvYXN0LmpzJyk7XHJcblxyXG4vL+ivu1VSTOWPguaVsFxyXG5mdW5jdGlvbiB1cmxLZXkobmFtZSkge1xyXG4gICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoXCIoXnwmKVwiICsgbmFtZSArIFwiPShbXiZdKikoJnwkKVwiKTtcclxuICAgIHZhciByID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSkubWF0Y2gocmVnKTtcclxuICAgIGlmIChyICE9IG51bGwpIHJldHVybiBlbmNvZGVVUkkoclsyXSk7IHJldHVybiBudWxsO1xyXG59XHJcbi8v6K6+572uY29va2llXHJcbmZ1bmN0aW9uIHNldENvb2tpZShuYW1lLCB2YWx1ZSwgdGltZSkge1xyXG4gICAgdmFyIG9EYXRlID0gbmV3IERhdGUoKTtcclxuICAgIG9EYXRlLnNldFRpbWUob0RhdGUuZ2V0VGltZSgpICsgdGltZSk7XHJcbiAgICBkb2N1bWVudC5jb29raWUgPSBuYW1lICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSArICc7ZXhwaXJlcz0nICsgb0RhdGUudG9VVENTdHJpbmcoKTtcclxufVxyXG4vL+iOt+WPlmNvb2tpZVxyXG5mdW5jdGlvbiBnZXRDb29raWUobmFtZSkge1xyXG4gICAgdmFyIGFyciA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOyAnKTtcclxuICAgIHZhciBpID0gMDtcclxuICAgIGZvciAoaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgYXJyMiA9IGFycltpXS5zcGxpdCgnPScpO1xyXG5cclxuICAgICAgICBpZiAoYXJyMlswXSA9PSBuYW1lKSB7XHJcbiAgICAgICAgICAgIHZhciBnZXRDID0gZGVjb2RlVVJJQ29tcG9uZW50KGFycjJbMV0pO1xyXG4gICAgICAgICAgICByZXR1cm4gZ2V0QztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJyc7XHJcbn1cclxuLy/ml6XmnJ/orqHnrpfmmJ/mnJ9cclxuZnVuY3Rpb24gZ2V0RGF0ZVdlZWsoeWVhciwgbW9udGgsIGRheSkge1xyXG4gICAgdmFyIHRtcGRhdGUgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCAtIDEsIGRheSk7XHJcbiAgICB2YXIganNvbiA9IHtcclxuICAgICAgICAwOiAn5ZGo5pelJyxcclxuICAgICAgICAxOiAn5ZGo5LiAJyxcclxuICAgICAgICAyOiAn5ZGo5LqMJyxcclxuICAgICAgICAzOiAn5ZGo5LiJJyxcclxuICAgICAgICA0OiAn5ZGo5ZubJyxcclxuICAgICAgICA1OiAn5ZGo5LqUJyxcclxuICAgICAgICA2OiAn5ZGo5YWtJ1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGpzb25bdG1wZGF0ZS5nZXREYXkoKV07XHJcbn1cclxuLy/pqozor4Houqvku73or4FcclxuZnVuY3Rpb24gY2hlY2tJZGVudGl0eShpZGVudGl0eSkge1xyXG4gICAgdmFyIHJlZyA9IC9eWzEtOV17MX1bMC05XXsxNH0kfF5bMS05XXsxfVswLTldezE2fShbMC05XXxbeFhdKSQvO1xyXG4gICAgaWYgKHJlZy50ZXN0KGlkZW50aXR5KSkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuXHJcbnZhciBib3R0b21Ub3RhbFByaSA9ICQoJyNib3R0b21Ub3RhbFByaScpLFxyXG4gICAgS0MgPSArZ2V0Q29va2llKCdrYycpLFxyXG4gICAgbm93VG90YWwgPSAxOyAgICAgICAvL+aIkOS6uu+8jOWEv+erpeW3sumAieelqOaVsOeahOaAu+aVsOmHj1xyXG5cclxuLy/ku451cmzlj5bmlbDmja5cclxudmFyIG9uZVByaWNlID0gZ2V0Q29va2llKCdwcmljZScpLCAgIC8v5oiQ5Lq65Lu35qC8XHJcbiAgICBjb2RlID0gdXJsS2V5KCdzaG9wQ29kZScpLCAgICAgICAgICAgLy/llYblk4FpZFxyXG4gICAgdHlwZSA9IHVybEtleSgnc2hvcFR5cGUnKSwgICAgICAgICAgIC8v5ZWG5ZOB57G75Z6LXHJcbiAgICBuYW1lID0gZ2V0Q29va2llKCduYW1lJyksICAgICAgICAvL+WVhuWTgeWQjVxyXG4gICAgemZJbmZvID0gZ2V0Q29va2llKCd6ZkluZm8nKSwgICAgLy/oh6rotLnpobnnm65cclxuICAgIGRhdGUgPSBnZXRDb29raWUoJ2RhdGUnKSwgICAgICAgIC8v5Ye65ri45pel5pyfXHJcbiAgICBkYXRlQXJyID0gZGF0ZS5zcGxpdCgnLScpLFxyXG4gICAgY2hpbGRQcmljZSA9IGdldENvb2tpZSgnY2hpbGRQcmljZScpLCAgIC8v5YS/56ul5Lu35qC8XHJcbiAgICBkZmMgPSBnZXRDb29raWUoJ2RmYycpLFxyXG4gICAgemMgPSBnZXRDb29raWUoJ3pjJyk7XHJcblxyXG4kKCcjdGlja2V0VGltZScpLnRleHQoZGF0ZSArICcoJyArIGdldERhdGVXZWVrKGRhdGVBcnJbMF0sIGRhdGVBcnJbMV0sIGRhdGVBcnJbMl0pICsgJyknKTtcclxuJCgnI3RvdGFsUHJpJykudGV4dChvbmVQcmljZSk7XHJcbiQoJyNib3R0b21Ub3RhbFByaScpLnRleHQob25lUHJpY2UpO1xyXG5cclxuLy/llYblk4HlkI3lrZjljYrlsI/ml7Zjb29raWXvvIzliKTmlq3mmK/lkKbmnInllYblk4HlkI1cclxuaWYgKG5hbWUpIHtcclxuICAgICQoJyN0aWNrZXROYW1lJykudGV4dChuYW1lKTtcclxufSBlbHNlIHtcclxuICAgIC8v5rKh5pyJ55qE6K+d6Lez6L2s5ZWG5ZOB6K+m5oOF6aG16Z2iXHJcbiAgICBsb2NhdGlvbi5ocmVmID0gY29udHJvbGxlciArICcvcF9yb3V0ZT9zaG9wQ29kZT0nICsgY29kZSArICcmc2hvcFR5cGU9JyArIHR5cGU7XHJcbn1cclxuXHJcbi8v6Ieq6LS56aG555uu5L+h5oGvXHJcbnpmSW5mbyA9IEpTT04ucGFyc2UoemZJbmZvKTtcclxuaWYgKHR5cGVvZiB6ZkluZm8gPT0gJ3N0cmluZycpIHsgXHJcbiAgICAkKCcjemZUaXRsZScpLmhpZGUoKTtcclxufSBlbHNlIHtcclxuICAgICQoJyN6Zk51bScpLmh0bWwoaXRlbU51bSh6ZkluZm8pKTtcclxufVxyXG5cclxuLy/mmK/lkKblrZjlnKjlhL/nq6Xku7fkv6Hmga9cclxuaWYgKGNoaWxkUHJpY2UpIHtcclxuICAgICQoJyNwZW9wbGVOdW0nKS5hcHBlbmQocGVvcGxlTnVtKG9uZVByaWNlLCAn5oiQ5Lq6JywgMSksIHBlb3BsZU51bShjaGlsZFByaWNlLCAn5YS/56ulJywgMCkpO1xyXG59IGVsc2Uge1xyXG4gICAgJCgnI3Blb3BsZU51bScpLmFwcGVuZChwZW9wbGVOdW0ob25lUHJpY2UsICfkuronLCAxKSk7XHJcbn1cclxuXHJcbmlmIChkZmMpIHtcclxuICAgIFxyXG4gICAgJCgnI2RmY0JveCcpLmFwcGVuZCgnPHAgY2xhc3M9XCJzdWJ0aXRsZVwiPuWNleaIv+aVsOmHjzwvcD48ZGl2IGNsYXNzPVwibnVtLWJveFwiPicgK1xyXG4gICAgICAgICc8cCBjbGFzcz1cIm9uZS1wcmljZVwiPu+/pTxzcGFuIGNsYXNzPVwianNfcHJpXCI+JyArIGRmYyArICc8L3NwYW4+L+WNleaIv+W3rjwvcD4nICtcclxuICAgICAgICAnPGRpdiBjbGFzcz1cInNlbGVjdC1udW1cIj4nICtcclxuICAgICAgICAnPHAgY2xhc3M9XCJqc19yZWRcIj48aSBjbGFzcz1cImljb25mb250IGljb24tamlhbnNoYW9cIj48L2k+PC9wPicgK1xyXG4gICAgICAgICc8c3BhbiBpZD1cImRmY051bVwiIGNsYXNzPVwiY2hvb3NlLW51bVwiPjA8L3NwYW4+JyArXHJcbiAgICAgICAgJzxwIGNsYXNzPVwianNfYWRkXCI+PGkgY2xhc3M9XCJpY29uZm9udCBpY29uLXplbmdqaWFcIj48L2k+PC9wPicgK1xyXG4gICAgICAgICc8L2Rpdj48L2Rpdj4nKTtcclxuXHJcbiAgICAvL+WNleaIv+W3ruWinuWKoC/lh4/lsJFcclxuICAgICQoJyNkZmNCb3gnKS5vbignY2xpY2snLCAnLmpzX3JlZCcsIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgdmFyIHBhcmVudCA9ICQodGhpcykucGFyZW50cygnLm51bS1ib3gnKSxcclxuICAgICAgICAgICAgcHJpID0gK3BhcmVudC5maW5kKCcuanNfcHJpJykudGV4dCgpICogMTAwLFxyXG4gICAgICAgICAgICB0TnVtID0gcGFyZW50LmZpbmQoJy5jaG9vc2UtbnVtJyksXHJcbiAgICAgICAgICAgIG51bVZhbCA9ICt0TnVtLnRleHQoKTtcclxuXHJcbiAgICAgICAgaWYgKG51bVZhbCA9PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB0b3RhbFByaWNlID0gK2JvdHRvbVRvdGFsUHJpLnRleHQoKSAqIDEwMDtcclxuICAgICAgICB0TnVtLnRleHQobnVtVmFsIC09IDEpO1xyXG4gICAgICAgIHRvdGFsUHJpY2UgPSAoKHRvdGFsUHJpY2UgLSBwcmkpIC8gMTAwKS50b0ZpeGVkKDIpO1xyXG4gICAgICAgIE51bWJlcih0b3RhbFByaWNlKSA9PSB0b3RhbFByaWNlID8gYm90dG9tVG90YWxQcmkudGV4dChOdW1iZXIodG90YWxQcmljZSkpIDogdG90YWxQcmljZTtcclxuXHJcbiAgICB9KVxyXG5cclxuICAgICQoJyNkZmNCb3gnKS5vbignY2xpY2snLCAnLmpzX2FkZCcsIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgdmFyIHBhcmVudCA9ICQodGhpcykucGFyZW50cygnLm51bS1ib3gnKSxcclxuICAgICAgICAgICAgcHJpID0gK3BhcmVudC5maW5kKCcuanNfcHJpJykudGV4dCgpICogMTAwLFxyXG4gICAgICAgICAgICB0TnVtID0gcGFyZW50LmZpbmQoJy5jaG9vc2UtbnVtJyksXHJcbiAgICAgICAgICAgIG51bVZhbCA9ICt0TnVtLnRleHQoKTtcclxuXHJcbiAgICAgICAgaWYgKHpjKSB7XHJcbiAgICAgICAgICAgIGlmIChub3dUb3RhbCA9PSBudW1WYWwpIHtcclxuICAgICAgICAgICAgICAgIEFsZXJ0KCfljZXmiL/lt67lt7LkuI7kurrmlbDmlbDph4/kuIDoh7QnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChub3dUb3RhbCAtICgrJCgnLmNob29zZS1udW0ubWFuJykuZXEoMSkudGV4dCgpKSA9PSBudW1WYWwpIHtcclxuICAgICAgICAgICAgICAgIEFsZXJ0KCfljZXmiL/lt67lt7LkuI7miJDkurrmlbDph4/kuIDoh7QnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHRvdGFsUHJpY2UgPSArYm90dG9tVG90YWxQcmkudGV4dCgpICogMTAwO1xyXG4gICAgICAgIHROdW0udGV4dChudW1WYWwgKz0gMSk7XHJcbiAgICAgICAgdG90YWxQcmljZSA9ICgodG90YWxQcmljZSArIHByaSkgLyAxMDApLnRvRml4ZWQoMik7XHJcbiAgICAgICAgTnVtYmVyKHRvdGFsUHJpY2UpID09IHRvdGFsUHJpY2UgPyBib3R0b21Ub3RhbFByaS50ZXh0KE51bWJlcih0b3RhbFByaWNlKSkgOiB0b3RhbFByaWNlO1xyXG5cclxuICAgIH0pXHJcbn1cclxuXHJcbi8v5oiQ5Lq65YS/56ul5LiN5ZCM56Wo5Lu3XHJcbmZ1bmN0aW9uIHBlb3BsZU51bShwcmljZSwgbWFudHlwZSwgbnVtKSB7XHJcbiAgICB2YXIgaHRtbCA9ICc8ZGl2IGNsYXNzPVwibnVtLWJveFwiPicgK1xyXG4gICAgICAgICc8cCBjbGFzcz1cIm9uZS1wcmljZVwiPu+/pTxzcGFuIGNsYXNzPVwianNfcHJpXCI+JyArIHByaWNlICsgJzwvc3Bhbj4vJyArIG1hbnR5cGUgKyAnPC9wPicgK1xyXG4gICAgICAgICc8ZGl2IGNsYXNzPVwic2VsZWN0LW51bVwiPicgK1xyXG4gICAgICAgICc8cCBjbGFzcz1cImpzX3JlZFwiPjxpIGNsYXNzPVwiaWNvbmZvbnQgaWNvbi1qaWFuc2hhb1wiPjwvaT48L3A+JyArXHJcbiAgICAgICAgJzxzcGFuIGRhdGEtdHlwZT0nICsgbnVtICsgJyBjbGFzcz1cImNob29zZS1udW0gbWFuXCI+JyArIG51bSArICc8L3NwYW4+JyArXHJcbiAgICAgICAgJzxwIGNsYXNzPVwianNfYWRkXCI+PGkgY2xhc3M9XCJpY29uZm9udCBpY29uLXplbmdqaWFcIj48L2k+PC9wPicgK1xyXG4gICAgICAgICc8L2Rpdj48L2Rpdj4nO1xyXG5cclxuICAgIHJldHVybiBodG1sO1xyXG59XHJcblxyXG4vL+iHqui0uemhueebrlxyXG5mdW5jdGlvbiBpdGVtTnVtKGRhdGEpIHtcclxuXHJcbiAgICB2YXIgaHRtbCA9ICcnLFxyXG4gICAgICAgIGxlbiA9IGRhdGEubGVuZ3RoO1xyXG5cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwibnVtLWJveFwiPicgK1xyXG4gICAgICAgICAgICAnPHAgY2xhc3M9XCJvbmUtcHJpY2VcIj7vv6U8c3BhbiBjbGFzcz1cImpzX3ByaVwiPicgKyBkYXRhW2ldLnByaWNlICsgJzwvc3Bhbj4v5Lq6PC9wPicgK1xyXG4gICAgICAgICAgICAnPHAgY2xhc3M9XCJpdGVtLW5hbWVcIj4nICsgZGF0YVtpXS5uYW1lICsgJzwvcD4nICtcclxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJzZWxlY3QtbnVtXCI+JyArXHJcbiAgICAgICAgICAgICc8cCBjbGFzcz1cImpzX3JlZFwiPjxpIGNsYXNzPVwiaWNvbmZvbnQgaWNvbi1qaWFuc2hhb1wiPjwvaT48L3A+JyArXHJcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cImNob29zZS1udW0gemZcIj4wPC9zcGFuPicgK1xyXG4gICAgICAgICAgICAnPHAgY2xhc3M9XCJqc19hZGRcIj48aSBjbGFzcz1cImljb25mb250IGljb24temVuZ2ppYVwiPjwvaT48L3A+JyArXHJcbiAgICAgICAgICAgICc8L2Rpdj48L2Rpdj4nO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBodG1sO1xyXG59XHJcblxyXG4vL+WHj+WwkVxyXG4kKCcjdGlja2V0TnVtQm94Jykub24oJ2NsaWNrJywgJy5qc19yZWQnLCBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgdmFyIHBhcmVudCA9ICQodGhpcykucGFyZW50cygnLm51bS1ib3gnKTtcclxuICAgIHZhciBwcmkgPSArcGFyZW50LmZpbmQoJy5qc19wcmknKS50ZXh0KCkgKiAxMDA7XHJcbiAgICB2YXIgdE51bSA9IHBhcmVudC5maW5kKCcuY2hvb3NlLW51bScpO1xyXG4gICAgdmFyIG51bVZhbCA9ICt0TnVtLnRleHQoKTtcclxuXHJcbiAgICAvL+aVsOmHj+mAieaLqVxyXG4gICAgaWYgKHROdW0uaGFzQ2xhc3MoJ21hbicpKSB7XHJcbiAgICBcclxuICAgICAgICBpZiAodE51bS5hdHRyKCdkYXRhLXR5cGUnKSA9PSAnMScgJiYgbnVtVmFsID09IDEpIHtcclxuICAgICAgICAgICAgQWxlcnQoJ+aIkOS6uuacgOWwkei0reS5sOaVsOmHjzEnKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodE51bS5hdHRyKCdkYXRhLXR5cGUnKSA9PSAnMCcgJiYgbnVtVmFsID09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbm93VG90YWwgLT0gMTtcclxuXHJcbiAgICAgICAgdmFyIHpmSXRlbSA9ICQoJy5jaG9vc2UtbnVtLnpmJyksXHJcbiAgICAgICAgICAgIHByaWNlID0gemZJdGVtLnBhcmVudHMoJy5udW0tYm94JykuZmluZCgnLmpzX3ByaScpO1xyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHpmSXRlbS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoK3pmSXRlbS5lcShpKS50ZXh0KCkgPiBub3dUb3RhbCkge1xyXG4gICAgICAgICAgICAgICAgemZJdGVtLmVxKGkpLnRleHQobm93VG90YWwpO1xyXG4gICAgICAgICAgICAgICAgYm90dG9tVG90YWxQcmkudGV4dCgoK2JvdHRvbVRvdGFsUHJpLnRleHQoKSAqIDEwMCAtICtwcmljZS5lcShpKS50ZXh0KCkgKiAxMDApIC8gMTAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGRmY0RvbSA9ICQoJyNkZmNOdW0nKTtcclxuICAgICAgICBkZmNOdW0gPSArZGZjRG9tLnRleHQoKTtcclxuXHJcbiAgICAgICAgaWYgKGRmYyAmJiB0TnVtLmF0dHIoJ2RhdGEtdHlwZScpID09ICcxJykge1xyXG4gICAgICAgICAgICBpZiAoemMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChub3dUb3RhbCA8IGRmY051bSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRmY0RvbS50ZXh0KGRmY051bSAtPSAxKTtcclxuICAgICAgICAgICAgICAgICAgICBib3R0b21Ub3RhbFByaS50ZXh0KCgrYm90dG9tVG90YWxQcmkudGV4dCgpICogMTAwIC0gK2RmYyAqIDEwMCkgLyAxMDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5vd1RvdGFsIC0gKCskKCcuY2hvb3NlLW51bS5tYW4nKS5lcSgxKS50ZXh0KCkpIDwgZGZjTnVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGZjRG9tLnRleHQoZGZjTnVtIC09IDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJvdHRvbVRvdGFsUHJpLnRleHQoKCtib3R0b21Ub3RhbFByaS50ZXh0KCkgKiAxMDAgLSArZGZjICogMTAwKSAvIDEwMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgICAvL+iHqui0uemhueebrumAieaLqVxyXG4gICAgaWYgKHROdW0uaGFzQ2xhc3MoJ3pmJykpIHtcclxuICAgICAgICBpZiAobnVtVmFsID09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHZhciB0b3RhbFByaWNlID0gK2JvdHRvbVRvdGFsUHJpLnRleHQoKSAqIDEwMDtcclxuICAgIHROdW0udGV4dChudW1WYWwgLT0gMSk7XHJcbiAgICB0b3RhbFByaWNlID0gKCh0b3RhbFByaWNlIC0gcHJpKSAvIDEwMCkudG9GaXhlZCgyKTtcclxuICAgIE51bWJlcih0b3RhbFByaWNlKSA9PSB0b3RhbFByaWNlID8gYm90dG9tVG90YWxQcmkudGV4dChOdW1iZXIodG90YWxQcmljZSkpIDogdG90YWxQcmljZTtcclxufSlcclxuXHJcbi8v5aKe5YqgXHJcbiQoJyN0aWNrZXROdW1Cb3gnKS5vbignY2xpY2snLCAnLmpzX2FkZCcsIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB2YXIgcGFyZW50ID0gJCh0aGlzKS5wYXJlbnRzKCcubnVtLWJveCcpLFxyXG4gICAgICAgIHByaSA9ICtwYXJlbnQuZmluZCgnLmpzX3ByaScpLnRleHQoKSAqIDEwMCxcclxuICAgICAgICB0TnVtID0gcGFyZW50LmZpbmQoJy5jaG9vc2UtbnVtJyksXHJcbiAgICAgICAgbnVtVmFsID0gK3ROdW0udGV4dCgpO1xyXG5cclxuICAgIGlmICh0TnVtLmhhc0NsYXNzKCdtYW4nKSkge1xyXG5cclxuICAgICAgICBpZiAobm93VG90YWwgPCBLQykge1xyXG4gICAgICAgICAgICBub3dUb3RhbCArPSAxO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIEFsZXJ0KCflt7Lovr7liLDlupPlrZjkuIrpmZAnKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvL+iHqui0uemhueebrumAieaLqVxyXG4gICAgaWYgKHROdW0uaGFzQ2xhc3MoJ3pmJykpIHtcclxuICAgICAgICBpZiAobnVtVmFsID09IG5vd1RvdGFsKSB7XHJcbiAgICAgICAgICAgIEFsZXJ0KCfmlbDph4/lt7LkuI7kurrmlbDkuIDoh7QnKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB2YXIgdG90YWxQcmljZSA9ICtib3R0b21Ub3RhbFByaS50ZXh0KCkgKiAxMDA7XHJcbiAgICB0TnVtLnRleHQobnVtVmFsICs9IDEpO1xyXG4gICAgdG90YWxQcmljZSA9ICgodG90YWxQcmljZSArIHByaSkgLyAxMDApLnRvRml4ZWQoMik7XHJcbiAgICBOdW1iZXIodG90YWxQcmljZSkgPT0gdG90YWxQcmljZSA/IGJvdHRvbVRvdGFsUHJpLnRleHQoTnVtYmVyKHRvdGFsUHJpY2UpKSA6IHRvdGFsUHJpY2U7XHJcblxyXG59KVxyXG5cclxuXHJcblxyXG4vL+WOu+Whq+WGmea4uOWuouS/oeaBr1xyXG4kKCcjZ29Ub3VyQnRuJykuY2xpY2soZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIGlmICgkKCcjcmVzZXJ2ZUNoZWNrJykucHJvcCgnY2hlY2tlZCcpKSB7XHJcblxyXG4gICAgICAgIGlmIChjb25maXJtKCfmmK/lkKbnoa7orqQnICsgJCgnI3RpY2tldFRpbWUnKS50ZXh0KCkgKyAn5Ye66KGMPycpKSB7XHJcbiAgICAgICAgICAgICQoJyNyZXNlcnZlTWVzcycpLmZhZGVPdXQoMjAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkKCcjdG91cnJpc3RNZXNzJykuZmFkZUluKDIwMCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdmFyIHJlc1ByaWNlID0gYm90dG9tVG90YWxQcmkudGV4dCgpO1xyXG4gICAgICAgICAgICAkKCcjb3JkZXJUb3RhbFByaScpLnRleHQocmVzUHJpY2UpO1xyXG5cclxuICAgICAgICAgICAgdmFyIG1hbk51bSA9ICQoJy5jaG9vc2UtbnVtLm1hbicpO1xyXG4gICAgICAgICAgICBpZiAobWFuTnVtLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXRlbU51bSA9ICttYW5OdW0udGV4dCgpIC0gMTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciBpdGVtTnVtID0gK21hbk51bS5lcSgwKS50ZXh0KCkgKyArbWFuTnVtLmVxKDEpLnRleHQoKSAtIDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGh0bWwgPSAnJztcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbU51bTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwiaXRlbS1jb250YWluZXJcIj48ZGl2IGNsYXNzPVwiaXRlbS1ib3hcIj48cCBjbGFzcz1cIml0ZW0tcFwiPjxzcGFuIGNsYXNzPVwicmVkXCI+JyArIChpICsgMikgKyAnLjwvc3Bhbj7muLjlrqLlp5PlkI0gOiA8L3A+PGlucHV0IGNsYXNzPVwiaXRlbS1pbnAgbmFtZVwiIHBsYWNlaG9sZGVyPVwi5aeT5ZCNXCIgdHlwZT1cInRleHRcIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cIml0ZW0tYm94XCI+PHAgY2xhc3M9XCJpdGVtLXBcIj7ouqvku73or4Hlj7cgOiA8L3A+PGlucHV0IGNsYXNzPVwiaXRlbS1pbnAgaWRlbnRpZnlcIiB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwi6Iul5piv5YS/56ul6L6T5YWl5Ye655Sf5pel5pyfXCI+PC9kaXY+PC9kaXY+JztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgJCgnI3NlY0l0ZW0nKS5odG1sKGh0bWwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIEFsZXJ0KCfor7flhYjnoa7orqTpooTlrprpobvnn6UhISEnKTtcclxuICAgIH1cclxufSlcclxuXHJcbi8v6L+U5ZueXHJcbiQoJy5pY29uZm9udC5pY29uLXp1b2ppYW50b3UnKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAkKCcjdG91cnJpc3RNZXNzJykuZmFkZU91dCgyMDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkKCcjcmVzZXJ2ZU1lc3MnKS5mYWRlSW4oMjAwKTtcclxuICAgIH0pO1xyXG59KVxyXG5cclxuLy/noa7orqTkuIvljZVcclxuJCgnI3Rha2VPcmRlckJ0bicpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB2YXIgdG91ck5hbWUgPSAkKCcjdG91ck5hbWUnKS52YWwoKTtcclxuICAgIGlmICghdG91ck5hbWUpIHtcclxuICAgICAgICBBbGVydCgn6K+35aGr5YaZ56ysMeS9jea4uOWuoueahOecn+WunuWnk+WQjSEnKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHRvdXJNb2JpbGUgPSAkKCcjdG91ck1vYmlsZScpLnZhbCgpO1xyXG4gICAgaWYgKHRvdXJNb2JpbGUpIHtcclxuICAgICAgICBpZiAoISgvXjFcXGR7MTB9JC8udGVzdCh0b3VyTW9iaWxlKSkpIHtcclxuICAgICAgICAgICAgQWxlcnQoXCLnrKwx5L2N5ri45a6i5omL5py65Y+356CB5pyJ6K+v77yM6K+36YeN5aGrXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBBbGVydCgn6K+35aGr5YaZ56ysMeS9jea4uOWuoueahOaJi+acuuWPt+eggSEnKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHRvdXJJZGVudGlmeSA9ICQoJyN0b3VySWRlbnRpZnknKS52YWwoKTtcclxuICAgIGlmICh0b3VySWRlbnRpZnkpIHtcclxuICAgICAgICBpZiAoIWNoZWNrSWRlbnRpdHkodG91cklkZW50aWZ5KSkge1xyXG4gICAgICAgICAgICBBbGVydCgn56ysMeS9jea4uOWuoui6q+S7veivgeWPt+eggemUmeivryEnKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgQWxlcnQoJ+ivt+i+k+WFpeesrDHkvY3muLjlrqLnmoTouqvku73or4Hlj7fnoIEhJyk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciByZW1hcmtzID0gJCgnI3JlbWFya3MnKS52YWwoKTtcclxuXHJcbiAgICB2YXIgZGF0YSA9IHt9O1xyXG4gICAgZGF0YS5pbmZvID0gW107XHJcblxyXG4gICAgdmFyIGxlbiA9ICQoJy5pdGVtLWNvbnRhaW5lcicpLmxlbmd0aDtcclxuXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGl0ZW1Db250YWluZXIgPSAkKCcuaXRlbS1jb250YWluZXInKS5lcShpKTtcclxuICAgICAgICB2YXIgbmFtZVZhbCA9IGl0ZW1Db250YWluZXIuZmluZCgnLm5hbWUnKS52YWwoKTtcclxuICAgICAgICB2YXIgaWRldFZhbCA9IGl0ZW1Db250YWluZXIuZmluZCgnLmlkZW50aWZ5JykudmFsKCk7XHJcblxyXG4gICAgICAgIGlmICghbmFtZVZhbCkge1xyXG4gICAgICAgICAgICBBbGVydCgn6K+36L6T5YWl56ysJyArIChpICsgMikgKyAn5L2N5ri45a6i55qE5aeT5ZCNIScpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWlkZXRWYWwpIHtcclxuICAgICAgICAgICAgQWxlcnQoJ+ivt+i+k+WFpeesrCcgKyAoaSArIDIpICsgJ+S9jea4uOWuoueahOi6q+S7veivgeaIluWHuueUn+aXpeacnyEnKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGpzb24gPSB7XHJcbiAgICAgICAgICAgIG5hbWU6IG5hbWVWYWwsXHJcbiAgICAgICAgICAgIGlkZW50aWZ5OiBpZGV0VmFsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBkYXRhLmluZm8ucHVzaChqc29uKTsgIC8v6Lqr5Lu95pWw57uEXHJcbiAgICB9XHJcblxyXG4gICAgZGF0YS5nX2NvZGUgPSB1cmxLZXkoJ3Nob3BDb2RlJyk7XHJcbiAgICBkYXRhLmdfdXNlcl9pZCA9IGdldENvb2tpZSgndXNlcicpO1xyXG4gICAgZGF0YS5pZGVudGlmaWNhdGlvbiA9IHRvdXJJZGVudGlmeTtcclxuXHJcbiAgICBkYXRhLm1vYmlsZSA9IHRvdXJNb2JpbGU7IC8v5ri45a6i5omL5py6XHJcbiAgICBkYXRhLm5hbWUgPSB0b3VyTmFtZTsgICAgIC8v56ys5LiA5L2N5ri45a6i5aeT5ZCNXHJcbiAgICBkYXRhLmp4c2NvZGUgPSAnJzsgICAgICAgIC8v5Lul5ZCO55qE5YiG6ZSA5ZWGcGlkXHJcbiAgICBkYXRhLnJlbWFya3MgPSByZW1hcmtzOyAgIC8v5aSH5rOoXHJcbiAgICBkYXRhLmdfb25fdGltZSA9IGRhdGU7ICAgIC8v5Ye66KGM5pe26Ze0XHJcbiAgICBkYXRhLmRmY051bSA9ICskKCcjZGZjTnVtJykudGV4dCgpO1xyXG5cclxuICAgIGlmICh6ZkluZm8pIHtcclxuICAgICAgICB2YXIgemZOdW0gPSAkKCcuY2hvb3NlLW51bS56ZicpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgemZJbmZvLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHpmSW5mb1tpXS5udW0gPSB6Zk51bS5lcShpKS50ZXh0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy/oh6rotLnpobnnm67kv6Hmga9cclxuICAgIGRhdGEuemZJbmZvID0gemZJbmZvO1xyXG5cclxuICAgIHZhciBtYW5OdW0gPSAkKCcuY2hvb3NlLW51bS5tYW4nKTtcclxuICAgIC8v5oiQ5Lq6IOWEv+erpeaVsOmHj1xyXG4gICAgaWYgKG1hbk51bS5sZW5naHQgPT0gMSkge1xyXG4gICAgICAgIGRhdGEubWVuTnVtID0gbWFuTnVtLnRleHQoKTtcclxuICAgICAgICBkYXRhLmNoaWxkTnVtID0gMDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZGF0YS5tZW5OdW0gPSBtYW5OdW0uZXEoMCkudGV4dCgpO1xyXG4gICAgICAgIGRhdGEuY2hpbGROdW0gPSBtYW5OdW0uZXEoMSkudGV4dCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGRhdGEudG90YWxQcmljZSA9ICQoJyNvcmRlclRvdGFsUHJpJykudGV4dCgpOyAgLy/mgLvku7dcclxuXHJcbiAgICB2YXIgX3RoaXMgPSAkKHRoaXMpO1xyXG5cclxuICAgIF90aGlzLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XHJcbiAgICBfdGhpcy5jc3MoJ2JhY2tncm91bmRDb2xvcicsICcjZmZhNjljJyk7XHJcblxyXG4gICAgdG9hc3Quc2hvdygpO1xyXG5cclxuICAgICQuYWpheCh7XHJcbiAgICAgICAgdXJsOiAnaHR0cDovL3d3dy5zdWl5aXlvdS5uZXQvaW5kZXgucGhwL3dlaXhpbi9PcmRlci9hZGRHcm91cE9yZGVyJyxcclxuICAgICAgICBkYXRhOiBkYXRhLFxyXG4gICAgICAgIHR5cGU6ICdQT1NUJyxcclxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgIHRvYXN0LmhpZGUoKTtcclxuICAgICAgICAgICAgdmFyIGNvZGUgPSByZXMuY29kZSxcclxuICAgICAgICAgICAgICAgIGRhdGEgPSByZXMuZGF0YTtcclxuICAgICAgICAgICAgaWYgKGNvZGUgPT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gJ2h0dHA6Ly93d3cuc3VpeWl5b3UubmV0L2luZGV4LnBocC9XZWl4aW4vSnNhcGkvaW5kZXg/Jm9yZGVyU249JyArIGRhdGEub3JkZXJTbiArICcmc2hvcFR5cGU9JyArIHR5cGUgKyAnJic7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBBbGVydChyZXMubXNnKTtcclxuICAgICAgICAgICAgICAgIF90aGlzLnByb3AoJ2Rpc2FibGVkJywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuY3NzKCdiYWNrZ3JvdW5kQ29sb3InLCAnI2ZmMTkwMCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufSlcclxuXHJcbkNPTkZJRy5qc0FwaUxpc3QgPSBbICAgIC8v6ZyA6KaB6LCD55So55qE5o6l5Y+jXHJcbiAgICAnb25NZW51U2hhcmVUaW1lbGluZScsXHJcbiAgICAnb25NZW51U2hhcmVBcHBNZXNzYWdlJ1xyXG5dXHJcbnd4LmNvbmZpZyhDT05GSUcpO1xyXG52YXIgbGluaztcclxuaWYodXJsS2V5KCdwaWQnKSl7XHJcbiAgICBsaW5rID0gbG9jYXRpb24uaHJlZjtcclxufWVsc2V7XHJcbiAgICBsaW5rID0gbG9jYXRpb24uaHJlZiArICcmcGlkPScgKyBnZXRDb29raWUoJ3BpZCcpO1xyXG59XHJcbnd4LnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAgIC8v5YiG5Lqr5pyL5Y+L5ZyIXHJcbiAgICB3eC5vbk1lbnVTaGFyZVRpbWVsaW5lKHtcclxuICAgICAgICB0aXRsZTogZG9jdW1lbnQudGl0bGUsXHJcbiAgICAgICAgbGluazogbGluayxcclxuICAgICAgICBpbWdVcmw6IHB1YmxpYyArICcvV2VpeGluL2ltYWdlL3d4YmcucG5nJ1xyXG4gICAgfSk7XHJcbiAgICAvL+WIhuS6q+aci+WPi1xyXG4gICAgd3gub25NZW51U2hhcmVBcHBNZXNzYWdlKHtcclxuICAgICAgICB0aXRsZTogZG9jdW1lbnQudGl0bGUsXHJcbiAgICAgICAgZGVzYzogJ+aIkeeahOaXhea4uOWwj+W6l++8jOmaj+aIkeW/g++8jOa4uOWkqeS4iycsXHJcbiAgICAgICAgbGluazogbGluayxcclxuICAgICAgICBpbWdVcmw6IHB1YmxpYyArICcvV2VpeGluL2ltYWdlL3d4YmcucG5nJyxcclxuICAgIH0pO1xyXG59KVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2Rfcm91dGUvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIDEiLCIvLyByZW1vdmVkIGJ5IGV4dHJhY3QtdGV4dC13ZWJwYWNrLXBsdWdpblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2Rfcm91dGUvaW5kZXguc2Nzc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAgMSIsInZhciBBbGVydCA9IGZ1bmN0aW9uKGNvbnRlbnQpIHtcclxuICAgIHZhciAkYm94ID0gJCgnPGRpdj48L2Rpdj4nKSxcclxuICAgICAgICAkaSA9ICQoJzxpIGNsYXNzPVwiaWNvbmZvbnQgaWNvbi1qaW5nZ2FvXCI+PC9pPicpLFxyXG4gICAgICAgICRzcGFuID0gJCgnPHNwYW4+PC9zcGFuPicpO1xyXG5cclxuICAgICRib3guY3NzKHtcclxuICAgICAgICBwb3NpdGlvbjogJ2ZpeGVkJyxcclxuICAgICAgICB0ZXh0QWxpZ246ICdjZW50ZXInLFxyXG4gICAgICAgIHdpZHRoOiAnMTgwcHgnLFxyXG4gICAgICAgIGJvdHRvbTogJzMwcHgnLFxyXG4gICAgICAgIGxlZnQ6ICdjYWxjKDUwJSAtIDkwcHgpJyxcclxuICAgICAgICBmb250U2l6ZTogJzEycHgnLFxyXG4gICAgICAgIGJvcmRlclJhZGl1czogJzNweCcsXHJcbiAgICAgICAgY29sb3I6ICcjZmZmJyxcclxuICAgICAgICBvcGFjaXR5OiAnMC4xJyxcclxuICAgICAgICBiYWNrZ3JvdW5kOiAncmdiYSgwLDAsMCwwLjcpJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgJHNwYW4uY3NzKHtcclxuICAgICAgICBsaW5lSGVpZ2h0OiAnMjVweCcsXHJcbiAgICB9KVxyXG5cclxuICAgICRzcGFuLmFwcGVuZChjb250ZW50KTtcclxuICAgICRib3guYXBwZW5kKCRzcGFuKTtcclxuICAgICQoJ2JvZHknKS5hcHBlbmQoJGJveCk7XHJcbiAgICAkYm94LmFuaW1hdGUoe1xyXG4gICAgICAgIG9wYWNpdHk6ICcxJyxcclxuICAgICAgICBib3R0b206ICc1MHB4J1xyXG4gICAgfSwgMjAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRib3guYW5pbWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAnMC4xJyxcclxuICAgICAgICAgICAgICAgIGJvdHRvbTogJzMwcHgnXHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRib3gucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSwgMTUwMClcclxuICAgIH0pXHJcbn1cclxuXHJcbmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcclxuICAgIG1vZHVsZS5leHBvcnRzID0gQWxlcnQ7XHJcbn0gZWxzZSB7XHJcbiAgICB3aW5kb3cuZGF0ZVByaWNlID0gQWxlcnQ7XHJcbn1cclxuXHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4uL2NvbW1vbi9BbGVydC1tYi5qc1xuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAgMSIsImZ1bmN0aW9uIHRvYXN0KCkge1xyXG5cclxuICAgIHRoaXMuY29udGFpbmVyID0gJCgnPGRpdj48L2Rpdj4nKTtcclxuXHJcbiAgICB0aGlzLmNvbnRhaW5lci5wcm9wKCdpZCcsICdsb2FkaW5nUGMnKTtcclxuXHJcbiAgICB2YXIgbG9hZGluZyA9ICQoJzxkaXY+PC9kaXY+Jyk7XHJcbiAgICB0aGlzLmNvbnRhaW5lci5wcm9wKCdjbGFzcycsICdsb2FkaW5nLWJveCcpO1xyXG5cclxuICAgIHZhciBwID0gJCgnPHA+6K+356iN5ZCOPC9wPicpO1xyXG5cclxuICAgIHZhciBzdmcgPSAkKCc8aW1nIHNyYz1cImh0dHA6Ly93d3cuc3VpeWl5b3UubmV0L1B1YmxpYy9jb21tb24vbG9hZGluZy5zdmdcIj4nKTtcclxuXHJcbiAgICB0aGlzLmNvbnRhaW5lci5jc3Moe1xyXG4gICAgICAgIHBvc2l0aW9uOiAnZml4ZWQnLFxyXG4gICAgICAgIGxlZnQ6IDAsXHJcbiAgICAgICAgdG9wOiAwLFxyXG4gICAgICAgIHdpZHRoOiAnMTAwJScsXHJcbiAgICAgICAgaGVpZ2h0OiAnMTAwJScsXHJcbiAgICAgICAgekluZGV4OiA5OSxcclxuICAgICAgICBkaXNwbGF5OiAnbm9uZSdcclxuICAgIH0pO1xyXG5cclxuICAgIGxvYWRpbmcuY3NzKHtcclxuICAgICAgICB3aWR0aDogJzEwMHB4JyxcclxuICAgICAgICBoZWlnaHQ6ICcxMDBweCcsXHJcbiAgICAgICAgYmFja2dyb3VuZDogJ3JnYmEoMCwgMCwgMCwgMC41KScsXHJcbiAgICAgICAgYm9yZGVyUmFkaXVzOiAnMTBweCcsXHJcbiAgICAgICAgbWFyZ2luOiAnNzAlIGF1dG8gMCdcclxuICAgIH0pO1xyXG5cclxuICAgIHN2Zy5jc3Moe1xyXG4gICAgICAgIG1hcmdpbjogJzAgYXV0bycsXHJcbiAgICAgICAgcGFkZGluZ1RvcDogJzEwcHgnLFxyXG4gICAgICAgIGRpc3BsYXk6ICdibG9jaydcclxuICAgIH0pXHJcblxyXG4gICAgcC5jc3Moe1xyXG4gICAgICAgIHRleHRBbGlnbjogJ2NlbnRlcicsXHJcbiAgICAgICAgY29sb3I6ICcjZmZmJyxcclxuICAgICAgICBmb250U2l6ZTogJzE0cHgnLFxyXG4gICAgICAgIG1hcmdpblRvcDogJzVweCdcclxuICAgIH0pXHJcblxyXG4gICAgbG9hZGluZy5hcHBlbmQoc3ZnLCBwKTtcclxuICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZChsb2FkaW5nKTtcclxuICAgICQoJ2JvZHknKS5hcHBlbmQodGhpcy5jb250YWluZXIpO1xyXG5cclxuICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5zaG93KCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5oaWRlKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcclxuICAgIG1vZHVsZS5leHBvcnRzID0gbmV3IHRvYXN0KCk7XHJcbn0gZWxzZSB7XHJcbiAgICB3aW5kb3cudG9hc3QgPSBuZXcgdG9hc3QoKTtcclxufVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4uL2NvbW1vbi90b2FzdC5qc1xuLy8gbW9kdWxlIGlkID0gM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAgMSJdLCJzb3VyY2VSb290IjoiIn0=